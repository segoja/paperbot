<div class="h-100 flex-column flex-fill d-flex overflow-hidden rounded-0">
  <div class="offcanvas-header py-0 px-2"><span class="h5 card-title py-0">Setlist/Queue</span></div>
  <div class="offcanvas-header pt-0 pb-2 row g-0 border-bottom px-2">
    <div class="col">
      <BsButton @type="info" @onClick={{@toggleSetlist}} title="Setlist/queue manager"><FaIcon @icon="angle-right" /></BsButton>
      <button type="button" class="btn btn-secondary" {{on "click" this.togglePlayed}}>
        Show played ({{this.playedSongs.length}})
        <FaIcon @icon={{if this.currentUser.showPlayed "minus-square" "plus-square"}} @size="1x" />
      </button>
      <BsButton @type="secondary" @onClick={{this.queueHandler.exportQueue}} title="Download setlist intext"><FaIcon @icon="file-download" /></BsButton>
      <ButtonConfirm @btnClass="btn btn-danger" @btnIcon="trash-alt" @btnText="" @confirmDescription="If you do this while streaming you will wipe all requests. Are you sure?" @targetAction={{this.queueHandler.clearAll}} @buttonTitle="Wipe setlist" />
    </div>
    <div class="col-auto">
      <BsButton @type="secondary" @onClick={{@toggleSetlist}} title="Close setlist panel"><FaIcon @icon="times" /></BsButton>
    </div>
  </div>
  <div class="offcanvas-body row g-0 h-100 overflow-hidden py-0 px-0">
    <div 
      class="col listframe-setlist px-2 h-100" 
      id="songqueueofc" 
    >
       
      {{#if this.currentUser.showPlayed}}
        <div class="d-block" id="playedSlSongs">
          {{#each this.playedSongs as |playedsong|}}
            <div id="slofc-{{playedsong.id}}" class="alert alert-secondary w-100 text-decoration-none py-0 ps-2 pe-0 my-1 text-start row g-0">
              <button class="col border-0 text-start text-reset bg-transparent text-decoration-none" type="button" {{on "click" (fn this.queueHandler.requestStatus playedsong)}} >
                <div class="row g-0" role="presentation">
                  <div class="col"><small>{{nicer-date playedsong.timestamp format="YYYY/MM/DD HH:mm:ss"}}</small></div>
                  <div class="col-auto"><small class="pe-2">{{playedsong.user}}</small></div>
                </div>
                <div class="row g-0">
                  <div class="col alert-heading h6 {{if playedsong.processed "processed"}}">{{playedsong.fullText}}</div>
                </div>
              </button>
              <div class="col-auto">
                <button type="button" class="btn btn-sm handle align-top" {{on "click" (fn this.queueHandler.removePlayed playedsong)}}>
                  <FaIcon @icon="times" @size="1x" class="d-block" />
                </button>                  
              </div>
            </div>
          {{/each}}
        </div>
      {{/if}}
      <div class="d-block" 
        {{scroll-position position=this.scrollPendingPosition relative=false}}
        {{sortable-group groupName="setlistofc" onChange=(fn this.reorderItems this.queueHandler.pendingSongs)}}
      >
        {{#each this.queueHandler.pendingSongs as |pendingsong|}}
          <div id={{pendingsong.id}} class="row g-0 alert alert-info w-100 text-decoration-none py-0 px-0 my-1" {{sortable-item groupName="setlistofc" model=pendingsong}}>
            <div class="col-auto px-3 rounded-0 handle d-flex flex-row" {{sortable-handle}}>
              <div class="align-self-center">
                <FaIcon @icon="grip-vertical" @size="1x" class="d-block align-self-center" />
                <FaIcon @icon="grip-vertical" @size="1x" class="d-block align-self-center" />
              </div>
            </div>
            <button type="button" class="col border-0 text-start text-reset bg-transparent text-decoration-none" {{on "click" (fn this.queueHandler.requestStatus pendingsong)}}>
              <div class="col ps-2">
                <div class="row g-0">
                  <div class="col"><small>{{nicer-date pendingsong.timestamp format="YYYY/MM/DD HH:mm:ss"}}</small></div>
                  <div class="col-auto">
                    <small class="pe-1">{{pendingsong.user}}</small>
                  </div>                    
                </div>
                <div class="row">
                  <div class="col">
                    <div class="alert-heading h6 {{if pendingsong.processed "processed"}}">{{pendingsong.fullText}}</div>
                  </div>
                </div>
              </div>
            </button>
            <div class="col-auto">
              <button type="button" class="btn btn-sm handle align-top" {{on "click" (fn this.queueHandler.removePending pendingsong)}}>
                <FaIcon @icon="times" @size="1x" class="d-block" />
              </button>              
            </div>                
          </div> 
        {{/each}}
      </div>
    </div>
  </div>
  <div class="offcanvas-footer py-0 my-0 px-2 border-top">
    <span class="page-link disabled float-end bg-transparent border-0 text-secondary">Total: {{this.total}}</span>
  </div>  
</div>