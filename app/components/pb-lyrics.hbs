<BsForm @formLayout="inline" @model={{@song}} @onSubmit={{@saveSong}} class="d-flex flex-column flex-fill h-100" as |form|>
  <div class="row g-2">
    <div class="col"></div>
    <div class="d-lg-none col-auto px-3">
      <button type="button" class="btn btn-sm btn-secondary" {{on "click" this.toggleEdit}} alt="formatted text"><FaIcon @icon="pen" /> Edit</button>
      <button type="button" class={{if @song.viewMode "btn btn-sm btn-primary" "btn btn-sm btn-secondary"}} {{on "click" this.modeSwitch}} alt="formatted text"><FaIcon @icon="paragraph" /></button>
      <div class="btn-group btn-group-sm">
        <button type="button" class="btn btn-secondary" {{on "click" this.downKey}} alt="transpose down"><FaIcon @icon="down-long" /></button>
        <span class="btn btn-secondary disabled text-white">{{@song.transSteps}}</span>
        <button type="button" class="btn btn-secondary" {{on "click" this.upKey}} alt="transpose up"><FaIcon @icon="up-long" /></button>
      </div>
      <div class="btn-group btn-group-sm">
        <button type="button" class="btn btn-secondary" {{on "click" this.resetZoom}} alt="Reset zoom"><FaIcon @icon="undo" /></button>
        <button type="button" class="btn btn-secondary" {{on "click" this.subZoom}} alt="Zoom out"><FaIcon @icon="search-minus" /></button>
        <button type="button" class="btn btn-secondary" {{on "click" this.addZoom}} alt="Zoom in"><FaIcon @icon="search-plus" /></button>
      </div>
      <div class="btn-group btn-group-sm">
        <button type="button" class="btn btn-secondary {{if (eq @song.columns 0) "active"}}" {{on "click" this.autoColumn}} alt="Auto columns">
          <FaIcon @icon="columns" /> 
          {{if (gt @song.columns 0) @song.columns}}
        </button>
        <button type="button" class="btn btn-secondary px-1" {{on "click" this.lessColumn}} alt="Less columns"><FaIcon @icon="minus" /></button>
        <button type="button" class="btn btn-secondary px-1" {{on "click" this.moreColumn}} alt="More columns"><FaIcon @icon="plus" /></button>
      </div>
    </div>
    <div class="d-none d-lg-block col-lg-auto px-3">
      <button type="button" class="btn btn-secondary" {{on "click" this.toggleEdit}} alt="formatted text"><FaIcon @icon="pen" /> Edit</button>
      <button type="button" class={{if @song.viewMode "btn btn-primary" "btn btn-secondary"}} {{on "click" this.modeSwitch}} alt="formatted text"><FaIcon @icon="paragraph" /></button>
      <div class="btn-group">
        <button type="button" class="btn btn-secondary" {{on "click" this.downKey}} alt="transpose down"><FaIcon @icon="down-long" /></button>
        <span class="btn btn-secondary disabled text-white">{{@song.transSteps}}</span>
        <button type="button" class="btn btn-secondary" {{on "click" this.upKey}} alt="transpose up"><FaIcon @icon="up-long" /></button>
      </div>
      <div class="btn-group">
        <button type="button" class="btn btn-secondary" {{on "click" this.resetZoom}} alt="Reset zoom"><FaIcon @icon="undo" /></button>
        <button type="button" class="btn btn-secondary" {{on "click" this.subZoom}} alt="Zoom out"><FaIcon @icon="search-minus" /></button>
        <button type="button" class="btn btn-secondary" {{on "click" this.addZoom}} alt="Zoom in"><FaIcon @icon="search-plus" /></button>
      </div>
      <div class="btn-group">
        <button type="button" class="btn btn-secondary {{if (eq @song.columns 0) "active"}}" {{on "click" this.autoColumn}} alt="Auto columns">
          <FaIcon @icon="columns" /> 
          {{if (gt @song.columns 0) @song.columns}}
        </button>
        <button type="button" class="btn btn-secondary px-1" {{on "click" this.lessColumn}} alt="Less columns"><FaIcon @icon="minus" /></button>
        <button type="button" class="btn btn-secondary px-1" {{on "click" this.moreColumn}} alt="More columns"><FaIcon @icon="plus" /></button>
      </div>
    </div>
  </div>
  {{#if this.isEditing}}
    <div class="row flex-fill">
      <div class="col-12 flex-fill px-4">
        <div class="form-group row py-2 flex-fill h-100">            
          <div class="col-sm">   
            <Textarea @value={{@song.lyrics}} aria-label="Lyrics/tab" class="form-control h-100" placeholder="Write/paste your lyrics/tab here." rows="1" />
          </div>
        </div>
      </div>
    </div>
  {{else}}  
    <style>
      .fancy-columns-pre,
      .fancy-columns {
        font-size: {{@song.zoomLevel}}em!important; 
        column-count: {{@song.columns}}!important;
        column-rule-width: auto;
      }   
    </style>
    <div class="d-flex mx-0 p-0 flex-fill h-100 overflow-hidden" id="bodycontainer">
      <div class="row mx-0 flex-fill listframe-reader">
        <div class={{if @song.viewMode "fancy-columns" "fancy-columns-pre"}}>{{chord-parser @song.lyrics key=0 mode=@song.viewMode}}</div>
      </div>
    </div>
  {{/if}}  
</BsForm>